<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Events - EventHub</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/js/all.min.js"></script>
</head>
<body>
    <nav class="navbar">
        <div class="logo">
            <h1>EventHub</h1>
        </div>
        <ul class="nav-links">
            <li><a href="index.html">Home</a></li>
            <li><a href="events.html" class="active">Events</a></li>
            <li><a href="announcements.html">Announcements</a></li>
            <li><a href="about.html">About Us</a></li>
            <li><a href="profile.html" class="profile-link">Profile</a></li>
            <li><a href="#" class="login-btn" id="auth-btn">Login</a></li>
        </ul>
        <div class="burger">
            <div class="line1"></div>
            <div class="line2"></div>
            <div class="line3"></div>
        </div>
    </nav>

    <section class="events-container">
        <div class="events-header">
            <h1>Upcoming Events</h1>
            <div class="events-controls">
                <div class="search-filter">
                    <input type="text" id="event-search" placeholder="Search events...">
                    <select id="category-filter">
                        <option value="">All Categories</option>
                        <option value="educational">Educational</option>
                        <option value="social">Social</option>
                        <option value="professional">Professional</option>
                        <option value="cultural">Cultural</option>
                        <option value="important">Important</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                <button id="create-event-btn" class="btn-primary handler-only">Create New Event</button>
            </div>
        </div>

        <div class="events-grid" id="events-grid">
            <!-- Events will be dynamically populated here -->
            <div class="event-card">
                <div class="event-image">
                    <img src="images/default-event.jpg" alt="Event 1">
                </div>
                <div class="event-details">
                    <h3>Sample Event Title</h3>
                    <p class="event-meta"><i class="far fa-calendar-alt"></i> Date: April 15, 2025</p>
                    <p class="event-meta"><i class="fas fa-map-marker-alt"></i> Location: Sample Location</p>
                    <div class="event-category educational">Educational</div>
                    <a href="event-details.html?id=1" class="btn-secondary">View Details</a>
                </div>
            </div>
        </div>

        <div id="no-events-message" style="display: none;">
            <p>No events found matching your criteria.</p>
        </div>

        <div class="pagination" id="pagination">
            <!-- Pagination will be added here if needed -->
        </div>
    </section>

    <footer>
        <div class="footer-content">
            <div class="footer-section about">
                <h2>EventHub</h2>
                <p>Your one-stop platform for creating, managing, and discovering amazing events.</p>
                <div class="contact">
                    <span><i class="fas fa-envelope"></i> contact@eventhub.com</span>
                </div>
                <div class="socials">
                    <a href="#"><i class="fab fa-facebook"></i></a>
                    <a href="#"><i class="fab fa-twitter"></i></a>
                    <a href="#"><i class="fab fa-instagram"></i></a>
                </div>
            </div>
            <div class="footer-section links">
                <h2>Quick Links</h2>
                <ul>
                    <li><a href="events.html">Events</a></li>
                    <li><a href="announcements.html">Announcements</a></li>
                    <li><a href="about.html">About Us</a></li>
                    <li><a href="feedback.html">Feedback</a></li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            &copy; 2025 EventHub | All rights reserved
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Check login status and update navigation
            const userEmail = localStorage.getItem('userEmail');
            const userRole = localStorage.getItem('userRole');
            const authBtn = document.getElementById('auth-btn');
            
            if (userEmail) {
                authBtn.textContent = 'Logout';
                authBtn.classList.remove('login-btn');
                authBtn.classList.add('logout-btn');
                
                // Show handler-specific controls if user is a handler
                if (userRole === 'handler') {
                    document.querySelectorAll('.handler-only').forEach(element => {
                        element.style.display = 'block';
                    });
                }
            } else {
                authBtn.textContent = 'Login';
                authBtn.classList.remove('logout-btn');
                authBtn.classList.add('login-btn');
                
                // Hide handler-specific controls
                document.querySelectorAll('.handler-only').forEach(element => {
                    element.style.display = 'none';
                });
            }

            // Handle auth button click
            authBtn.addEventListener('click', function() {
                if (userEmail) {
                    // Logout
                    localStorage.removeItem('userEmail');
                    localStorage.removeItem('userRole');
                    window.location.reload();
                } else {
                    // Go to login
                    window.location.href = 'login.html';
                }
            });

            // Create Event button
            const createEventBtn = document.getElementById('create-event-btn');
            if (createEventBtn) {
                createEventBtn.addEventListener('click', function() {
                    window.location.href = 'create-event.html';
                });
            }

            // Load events from localStorage
            const events = JSON.parse(localStorage.getItem('events')) || [];
            const eventsGrid = document.getElementById('events-grid');
            const noEventsMessage = document.getElementById('no-events-message');
            
            // Sort events by date (most recent first)
            events.sort((a, b) => new Date(a.date) - new Date(b.date));
            
            // Function to display events based on filters
            function displayEvents(searchQuery = '', categoryFilter = '') {
                // Clear previous events
                eventsGrid.innerHTML = '';
                
                // Filter events
                const filteredEvents = events.filter(event => {
                    const matchesSearch = !searchQuery || 
                        event.title.toLowerCase().includes(searchQuery.toLowerCase()) ||
                        event.description.toLowerCase().includes(searchQuery.toLowerCase()) ||
                        event.location.toLowerCase().includes(searchQuery.toLowerCase());
                    
                    const matchesCategory = !categoryFilter || event.category === categoryFilter;
                    
                    return matchesSearch && matchesCategory;
                });
                
                // Display filtered events
                if (filteredEvents.length > 0) {
                    filteredEvents.forEach(event => {
                        const eventCard = document.createElement('div');
                        eventCard.className = 'event-card';
                        
                        const eventDate = new Date(event.date);
                        const formattedDate = eventDate.toLocaleDateString('en-US', { 
                            year: 'numeric', 
                            month: 'long', 
                            day: 'numeric' 
                        });
                        
                        eventCard.innerHTML = `
                            <div class="event-image">
                                <img src="${event.image || 'images/default-event.jpg'}" alt="${event.title}">
                            </div>
                            <div class="event-details">
                                <h3>${event.title}</h3>
                                <p class="event-meta"><i class="far fa-calendar-alt"></i> Date: ${formattedDate}</p>
                                <p class="event-meta"><i class="fas fa-map-marker-alt"></i> Location: ${event.location}</p>
                                <div class="event-category ${event.category.toLowerCase()}">${capitalizeFirstLetter(event.category)}</div>
                                <a href="event-details.html?id=${event.id}" class="btn-secondary">View Details</a>
                            </div>
                        `;
                        
                        eventsGrid.appendChild(eventCard);
                    });
                    
                    noEventsMessage.style.display = 'none';
                    eventsGrid.style.display = 'grid';
                } else {
                    noEventsMessage.style.display = 'block';
                    eventsGrid.style.display = 'none';
                }
            }
            
            // Initial display of events
            displayEvents();
            
            // Search functionality
            const searchInput = document.getElementById('event-search');
            searchInput.addEventListener('input', function() {
                const categoryFilter = document.getElementById('category-filter').value;
                displayEvents(this.value, categoryFilter);
            });
            
            // Category filter functionality
            const categoryFilter = document.getElementById('category-filter');
            categoryFilter.addEventListener('change', function() {
                const searchQuery = document.getElementById('event-search').value;
                displayEvents(searchQuery, this.value);
            });
        });
        
        // Helper function to capitalize first letter
        function capitalizeFirstLetter(string) {
            return string.charAt(0).toUpperCase() + string.slice(1);
        }
    </script>
</body>
</html>